CREATE OR REPLACE PROCEDURE TOTAL_AVAILABLE_SEATS(ID IN NUMBER,FROM_ST IN VARCHAR2,TO_ST VARCHAR2,JDATE VARCHAR2,SEAT_AC OUT NUMBER,SEAT_SN OUT NUMBER,SEAT_SC OUT NUMBER) IS
	TOT_SEAT_AC NUMBER;
	TOT_SEAT_SN NUMBER;
	TOT_SEAT_SC NUMBER;
	BOOKED_AC NUMBER;
	BOOKED_SN NUMBER;
	BOOKED_SC NUMBER;
BEGIN
	SELECT COUNT(*) INTO TOT_SEAT_AC FROM COMPARTMENTS C NATURAL JOIN SEATS S WHERE C.CLASS='AC_S';
	SELECT COUNT(*) INTO TOT_SEAT_SN FROM COMPARTMENTS C NATURAL JOIN SEATS S WHERE C.CLASS='SNIGDHA';
	SELECT COUNT(*) INTO TOT_SEAT_SC FROM COMPARTMENTS C NATURAL JOIN SEATS S WHERE C.CLASS='S_CHAIR'; 
	
	SELECT COUNT(*) INTO BOOKED_AC FROM RESERVATION R NATURAL JOIN BOOKED_SEATS B 
	WHERE R.FROM_ST=FROM_ST AND R.TO_ST=TO_ST AND R.DATE_OF_JOURNEY=JDATE AND
	B.COMPARTMENT_ID IN (SELECT COMPARTMENT_ID FROM COMPARTMENTS WHERE CLASS='AC_S' AND TRAIN_ID=ID);
	
	SELECT COUNT(*) INTO BOOKED_SN FROM RESERVATION R NATURAL JOIN BOOKED_SEATS B 
	WHERE R.FROM_ST=FROM_ST AND R.TO_ST=TO_ST AND R.DATE_OF_JOURNEY=JDATE AND
	B.COMPARTMENT_ID IN (SELECT COMPARTMENT_ID FROM COMPARTMENTS WHERE CLASS='SNIGDHA' AND TRAIN_ID=ID);
	
	SELECT COUNT(*) INTO BOOKED_SC FROM RESERVATION R NATURAL JOIN BOOKED_SEATS B 
	WHERE R.FROM_ST=FROM_ST AND R.TO_ST=TO_ST AND R.DATE_OF_JOURNEY=JDATE AND
	B.COMPARTMENT_ID IN (SELECT COMPARTMENT_ID FROM COMPARTMENTS WHERE CLASS='S_CHAIR' AND TRAIN_ID=ID);
	
	SEAT_AC:=TOT_SEAT_AC-BOOKED_AC;
	SEAT_SN:=TOT_SEAT_SN-BOOKED_SN;
	SEAT_SC:=TOT_SEAT_SC-BOOKED_SC;
	
END;
/