WITH A AS
(SELECT T1.TRAIN_ID AS TRAIN_ID, T1.STOP_NO AS FROM_ST_NO ,T2.STOP_NO AS TO_ST_NO , T1.STATION_ID AS FR_ST ,T2.STATION_ID AS TO_ST
  FROM TRAIN_STOPS T1 LEFT OUTER JOIN TRAIN_STOPS T2 ON T1.TRAIN_ID = T2.TRAIN_ID AND T1.STATION_ID <> T2.STATION_ID
),
B AS
(
SELECT A.TRAIN_ID AS TRAIN_ID
FROM A WHERE A.FR_ST = (SELECT STATION_ID FROM STATIONS WHERE STATION_NAME = 'Jashore') AND A.TO_ST = (SELECT STATION_ID FROM STATIONS WHERE STATION_NAME = 'Dhaka') AND
A.FROM_ST_NO > A.TO_ST_NO
)
SELECT B.TRAIN_ID 
FROM B 
WHERE NOT EXISTS
(
SELECT * FROM TRAIN_HOLIDAY WHERE TRAIN_HOLIDAY.TRAIN_ID = B.TRAIN_ID AND TRAIN_HOLIDAY.HOLIDAY_DATE = TO_DATE('2024-02-21', 'YYYY-MM-DD')
)